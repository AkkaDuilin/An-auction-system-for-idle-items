<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>{{tittle}}</title>
		<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
		<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
		<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js">
		</script>
		<script>
			$(document).ready(function() {
				var price = {{product_price}};
				var result = Math.ceil(price / 10);
				var result1 = Math.ceil(price / 50);
				document.getElementById("result").textContent = result;
				document.getElementById("result").textContent = result1;
			});
		</script>
		<script>
			$(document).ready(function() {
				// 设置倒计时的目标时间，这里假设目标时间为 2023 年 12 月 31 日 23:59:59
				var targetDate = {{auction_time}} + (60 * 60 * 60);
				var auction_data = {{auction_time}};
				// 更新倒计时显示的函数
				function updateCountdown() {
					// 获取当前时间
					var currentDate = new Date();
					if (auction_data > currentDate) {
						document.getElementById("countdown").textContent = "拍卖未开始";
					} else if (currentDate > targetDate) {
						document.getElementById("countdown").textContent = "拍卖已结束";
					} else {
						// 计算剩余时间（以毫秒为单位）
						var remainingTime = targetDate.getTime() - currentDate.getTime();

						// 判断剩余时间是否大于 0
						if (remainingTime > 0) {
							// 将剩余时间转换为天、小时、分钟、秒
							var days = Math.floor(remainingTime / (1000 * 60 * 60 * 24));
							var hours = Math.floor((remainingTime % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
							var minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));
							var seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);

							// 更新倒计时显示
							document.getElementById("countdown").textContent = days + " 天 " + hours + " 小时 " + minutes +
								" 分钟 " + seconds + " 秒";
						} else {
							// 如果剩余时间小于等于 0，则显示倒计时结束的消息
							document.getElementById("countdown").textContent = "倒计时结束";
						}
					}
				}

				// 初始调用一次更新倒计时函数，确保页面加载时即显示正确的倒计时
				updateCountdown();

				// 每秒钟更新一次倒计时
				setInterval(updateCountdown, 1000);
			});
		</script>
		<script type="text/javascript">
			$(document).ready(function() {
				var auction_data = {{auction_time}};
				var currentDate = new Date();
				if(auction_data>currentDate)
				{
					$('.add_goods').hide();
				}
			});
		</script>
	</head>
	<body>
		<nav class="navbar navbar-default" style="background-color: #ffa75e;" role="navigation">
			<div class="container-fluid">
				<div class="navbar-header">
					<a class="navbar-brand" href="#">拍卖网站</a>
				</div>
				<div>
					<ul class="nav navbar-nav">
						<li><a href="/">主页</a></li>
						<li><a href="#">个人订单</a></li>
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown">
								我的拍品
								<b class="caret"></b>
							</a>
							<ul class="dropdown-menu">
								<li><a href="/auction/manage/">拍品管理</a></li>
								<li><a href="#">拍品发货</a></li>
							</ul>
						</li>
						<li><a href="#">我的预约</a></li>
						<li><a href="#">联系客服</a></li>
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown">
								个人信息
								<b class="caret"></b>
							</a>
							<ul class="dropdown-menu">
								<li><a href="/user/info/">我的资料</a></li>
								<li><a href="/user/site/">收货地址</a></li>
								<li><a href="/user/history/">浏览记录</a></li>
								<li><a href="/user/logout/">退出登录</a></li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<div style="height: 10px;width: 100%;"></div>

		<div class="container">
			<div class="row">
				<div class="col-md-4">
					<div id="myCarousel" class="carousel slide">
						<!-- 轮播（Carousel）指标 -->
						<ol class="carousel-indicators">
							{% for image in auction.product_img %}
							<li data-target="#myCarousel" data-slide-to="{{ forloop.counter0 }}"
								{% if forloop.first %}class="active" {% endif %}></li>
							{% endfor %}
						</ol>
						<!-- 轮播（Carousel）项目 -->
						<div class="carousel-inner">
							{% for image in product.product_img %}
							<div class="item">
								<img src="{{ image.url }}" alt="Product Image" class="img-responsive" width="390"
									height="390">
							</div>
							{% endfor %}
						</div>
						<!-- 轮播（Carousel）导航 -->
						<a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
							<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
							<span class="sr-only">Previous</span>
						</a>
						<a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
							<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
							<span class="sr-only">Next</span>
						</a>
					</div>
					<div class="row">
						<h4>商品简介</h4>
						<p>&nbsp;&nbsp;{{product_abstract}}</p>
					</div>
				</div>
				<div class="col-md-4">
					<h4 class="row">起拍价格：{{auction_price}}</h4>
					{% if auction.price %}
					<h4 class="row">当前价格：{{auction_price}}</h4>
					{% else %}
					<h4 class="row">当前价格：拍卖未开始</h4>
					{% endif %}
					<div class="row">
						<div class="panel panel-default">
							<div class="panel-heading">
								当前出价情况
							</div>
							<div class="panel-body border" style="height: 180px;">
								{% if bid_count_list %}
								{% for bid_count in bid_count_list %}
								<h4>{{ bid_count }}</h4>
								{% endfor %}
								{% else %}
								<h4>当前无人参与拍卖</h4>
								{% endif %}
							</div>
						</div>
					</div>
					<div class="row">
						{% if auction_attends==0 %}
						<h5 class="col-md-6">参拍人数：{{ auction_attends }}</h5>
						{% else %}
						<h5 class="col-md-6">当前无人参与</h5>
						{% endif %}
						{% if auction_reserve==0 %}
						<h5 class="col-md-6">预约人数：{{ auction_reserve }}</h5>
						{% else %}
						<h5 class="col-md-6">当前无人预约</h5>
						{% endif %}
						<h5 class="col-md-6">保证金：<span id="result"></span></h5>
						<h5 class="col-md-6">拍卖时间：{{auction_tiem}}</h5>
						<h5 class="col-md-6">最少加价:<span id="result1"></span></h5>
						<h5 class="col-md-6">拍卖持续时间：60min</h5>
						<h5 class="col-md-12">倒计时剩余时间：<span id="countdown"></span></h5>
						<a href="javascript:;" class="add_goods col-md-6" id="{{ product.product_id }}"
							title="预约拍卖">预约拍卖</a>
						<a href="javascript:;" class="pay_for col-md-6" id="{{ product.product_id }}">支付保证金</a>
						<div class="row">
							<form role="form" method="post" action="/auction/{{product.product_id}}/bid">
								<div class="form-group col-md-8">
									<input type="text" class="form-control bid" id="bid_amount" name="{{auction_id}}" placeholder="请输入拍卖价格">
								</div>
								<button type="submit" class="btn btn-danger col-md-4">出价</button>
							</form>
						</div>
					</div>
				</div>
				<div class="col-md-4" style="background-color: cyan;">
					<h4 class="row">卖家：{{auction.auction_sell}}</h4>
					<h4 class="row">拍品详情：</h4>
					<p>&nbsp;&nbsp;{{auction.product_content}}</p>
				</div>
			</div>
		</div>

		<script type="text/javascript">
			$('.add_goods').click(function(){
				product_id = $(this).attr('id')
				$.get('/cart/add_' + product_id + '_1/', function(data) {
				});
			})
		</script>
		<script type="text/javascript">
			$('.payfor').click(function(){
				product_id = $(this).attr('id')
				$.get('/pay/' + product_id, function(data) {
				});
			})
		</script>
	</body>
</html>